window.Pluto=window.Pluto||{Validator:{}},window.Pluto.Validator.Email={filter:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,isValid:function(a){return this.filter.test(a)?!0:!1}},window.Pluto.Validator.PhoneNumber={filter:/^\+?\d+((-|\s|)\d+)*$/,isValid:function(a){return this.filter.test(a)?!0:!1}},window.Pluto.Validator.Username={invFilter:/[!,@,#,$,%,^,&,*,?,~,\-,(,),=,\/,.,\s,',"]/,isValid:function(a){return this.invFilter.test(a)?!1:!0}},window.Pluto.Validator.Password={minLength:7,minStrength:3,isMinLength:!1,strengthIndicatorClass:["strength-poor","strength-poor","strength-mild","strength-mild","strength-best"],init:function(a){this.$input=a.$input,this.$pwdStrengthBar=a.$pwdStrengthBar,this.minLength=a.minLength||this.minLength,this.pwdStrength=0,this.$input.on("keyup",$.proxy(this.computeStrength,this))},computeStrength:function(){this.pwdStrength=0,this.isMinLength=!1;var a=this.$input.val().trim();a.length>=this.minLength&&(this.pwdStrength+=1,this.isMinLength=!0),a.match(/[a-z]/)&&a.match(/[A-Z]/)&&(this.pwdStrength+=1),a.match(/\d+/)&&(this.pwdStrength+=1),a.match(/.[!,@,#,$,%,^,&,*,?,_,~,\-,(,)]/)&&(this.pwdStrength+=1),0===this.pwdStrength?this.indicateStrength(this.strengthIndicatorClass[0],"5%"):1===this.pwdStrength?this.indicateStrength(this.strengthIndicatorClass[1],"10%"):2===this.pwdStrength?this.indicateStrength(this.strengthIndicatorClass[2],"20%"):3===this.pwdStrength?this.indicateStrength(this.strengthIndicatorClass[3],"75%"):4===this.pwdStrength&&this.indicateStrength(this.strengthIndicatorClass[4],"100%")},indicateStrength:function(a,b){this.$pwdStrengthBar.removeClass(this.strengthIndicatorClass.join(" ")).addClass(a).css({width:b})},isValid:function(){return this.pwdStrength>=this.minStrength,!0&&this.isMinLength?!0:!1}},$(document).ready(function(){Pluto&&Pluto.Validator&&Pluto.Validator.Password&&Pluto.Validator.Password.init({$input:$("#tbPwd1"),$pwdStrengthBar:$(".pwd-strength-bar")});var a={email:!1,username:!1,contactNum:!1},b="";$("#frm-reg").on("submit",function(b){var c=$("#tbName").val().trim(),d=$("#tbEmail").val().trim(),e=$("#tbUsername").val().trim(),f=$("#tbContactNo").val().trim(),g=$("#tbPwd1").val().trim(),h=$("#tbPwd2").val().trim(),i={},j=$(this).find(".pacer");j.css({width:"0%"}),$(".js-check-me").blur(),""===c||""===d||""===g||""===h||""===e||""===f?(badger.show("Incomplete form","error"),$("#tbName").focus()):g!==h?(badger.show("Passwords don't match","error"),$("#tbPwd1").focus()):Pluto.Validator.Password.isValid()?Pluto.Validator.Email.isValid(d)?Pluto.Validator.Username.isValid(e)?Pluto.Validator.PhoneNumber.isValid(f)?a.email&&a.username&&a.contactNum?(j.show().animate({width:"50%"}),$("#btRegister").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Registering..."),i.name=c,i.email=d,i.password=g,i.username=e,i.contactNum=f,$.post("register",JSON.stringify(i),function(a){j.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btRegister").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Register")}),200===a.status?window.location.href="../custommsg?code=MSG08":badger.show("Something went wrong, please try again","error")})):(badger.show("Please correct the unavailable fields","error"),$("#tbEmail").focus()):(badger.show("Please provide a valid mobile number","warn"),$("#tbContactNo").focus()):(badger.show("Please provide a valid username","warn"),$("#tbUsername").focus()):(badger.show("Please provide a valid email address","warn"),$("#tbEmail").focus()):(badger.show("Password is not strong enough","error"),$("#tbPwd1").focus()),b.preventDefault()}),$(".js-check-me").on("blur",function(){var b=$(this),c=b.val().trim(),d=b.attr("name");c&&("email"!==d||Pluto.Validator.Email.isValid(c))&&("username"!==d||Pluto.Validator.Username.isValid(c))&&("contactNum"!==d||Pluto.Validator.PhoneNumber.isValid(c))&&(b.closest(".tb-hint-wrapper").find(".auto-checker").html('<span class="fa fa-refresh fa-spin"></span>'),$.get("../login/checkAvailability?entity="+d+"&value="+c).done(function(c){return 200!==c.status?void b.closest(".tb-hint-wrapper").find(".auto-checker").html('<span class="fa fa-times-circle" style="color: #fe4365"></span>'):void(c.data.result?(b.closest(".tb-hint-wrapper").find(".auto-checker").html('<span class="fa fa-check-circle"></span>'),a[d]=!0):(b.closest(".tb-hint-wrapper").find(".auto-checker").html('<span class="fa fa-times-circle" style="color: #fe4365"></span>'),a[d]=!1))}))}),$("#frm-reg-user").on("submit",function(a){var b=$("#tbName").val().trim(),c=$("#tbEmail").val().trim(),d=$("#tbPwd1").val().trim(),e=$("#tbPwd2").val().trim(),f={},g=$(this).find(".pacer");g.css({width:"0%"}),""===b||""===c||""===d||""===e?(badger.show("Incomplete form","error"),$("#tbName").focus()):d!==e?(badger.show("Passwords don't match","error"),$("#tbPwd1").focus()):Pluto.Validator.Password.isValid()?Pluto.Validator.Email.isValid(c)?(g.show().animate({width:"33%"}),$("#btRegister").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Registering..."),$.get("login/checkAvailability?entity=email&value="+c).done(function(a){return g.show().animate({width:"66%"}),200!==a.status?void g.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btRegister").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Register")}):a.data.result?(f.name=b,f.email=c,f.password=d,void $.post("user/register",JSON.stringify(f),function(a){g.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btRegister").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Register")}),200===a.status?window.location.href="custommsg?code=MSG01&email="+c:badger.show("Something went wrong, please try again","error")})):(badger.show("Email already registered","error",{stayTime:4}),void g.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btRegister").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Register")}))})):(badger.show("Please provide a valid email address","warn"),$("#tbEmail").focus()):(badger.show("Password is not strong enough","error"),$("#tbPwd1").focus()),a.preventDefault()}),$("#frm-chng-pwd").on("submit",function(a){var b=$("#tbPwdOld").val().trim(),c=$("#tbPwd1").val().trim(),d=$("#tbPwd2").val().trim(),e={},f=$(this),g=$(this).find(".pacer");return g.css({width:"0%"}),f.data("no-click")?(f.data("no-click",""),void a.preventDefault()):(""===b||""===c||""===d?(badger.show("Please fill complete form","error"),$("#tbPwdOld").focus()):c!==d?(badger.show("Passwords don't match","error"),$("#tbPwd1").focus()):Pluto.Validator.Password.isValid()?(g.show().animate({width:"33%"}),$("#btChangePwd").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Changing..."),e.oldPassword=b,e.newPassword=c,$.post("changePassword",JSON.stringify(e),function(a){return g.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btChangePwd").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Change")}),1003===a.status?void badger.show("Old password is not correct","error"):200!==a.status?void badger.show("Couldn't process request, please try again","error"):(badger.show("Password changed successfully"),f.closest(".modal").hide(),void f.find("input").val(""))})):(badger.show("Password is not strong enough","error"),$("#tbPwd1").focus()),void a.preventDefault())}),$(".js-no-click").on("click",function(){$(this).closest("form").data("no-click","yes")}),$(".js-frm-chng-entity").on("submit",function(a){var b=$(this),c=b.find("input").eq(0).attr("name").trim(),d=b.find("input").eq(0).val().trim(),e=b.find("input").eq(0).data("entity-name").trim(),f=b.data("to-update").trim(),g=$("#frm-ver-pwd");return b.find("input").eq(0).focus(),b.data("no-click")?(b.data("no-click",""),void a.preventDefault()):(d?"email"===c&&!Pluto.Validator.Email.isValid(d)||"contactNum"===c&&!Pluto.Validator.PhoneNumber.isValid(d)||"username"===c&&!Pluto.Validator.Username.isValid(d)?badger.show(e+" is not valid","warn"):(g.data("entity",c),g.data("value",d),g.data("dispName",e),g.data("toUpdate",f),$("#mdl-ver-pwd").show()):(badger.show("Please provide something to change","error"),b.find("input").eq(0).focus()),void a.preventDefault())}),$("#frm-ver-pwd").on("submit",function(a){var b=$(this),c=$(".js-frm-chng-entity"),d=b.find('input[type="password"]'),e=b.find("button").eq(0),f=b.find(".pacer"),g=b.data("entity"),h=b.data("value"),i=b.data("dispName"),j=b.data("toUpdate"),k=d.val().trim(),l={};return f.css({width:"0%"}),d.focus(),b.data("no-click")?(b.data("no-click",""),b.data("entity",""),b.data("value",""),b.data("dispName",""),b.data("toUpdate",""),d.val(""),void a.preventDefault()):(k?(f.show().animate({width:"33%"}),e.removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Verifying..."),$.post("../institute/isPasswordValid",JSON.stringify({password:k})).done(function(a){return 200!==a.status?(badger.show("Couldn't process request, please try again","error"),void f.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),e.addClass("btn-sheen-intrctve").prop("disabled",!1).text("Verify")})):void(a.data?$.get("../login/checkAvailability?entity="+g+"&value="+h).done(function(a){return 200!==a.status?(badger.show("Couldn't process request, please try again","error"),void f.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),e.addClass("btn-sheen-intrctve").prop("disabled",!1).text("Verify")})):void(a.data.result?(f.show().animate({width:"66%"}),l[g]=h,$.post("updateBasicInfo",JSON.stringify(l),function(a){return f.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),e.addClass("btn-sheen-intrctve").prop("disabled",!1).text("Verify")}),200!==a.status?void badger.show("Couldn't process request, please try again","error"):("email"===g?badger.show("A verification email has been sent to "+h,{stayTime:10}):badger.show(i+" changed successfully"),"username"===g&&(window.location.href="../logout"),b.closest(".modal").hide(),c.closest(".modal").hide(),b.find("input").val(""),c.find("input").val(""),void $(j).text(h))})):(badger.show(i+" is unavailable","warn"),f.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),e.addClass("btn-sheen-intrctve").prop("disabled",!1).text("Verify")}),d.val("").focus()))}):(badger.show("Wrong password","error"),f.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),e.addClass("btn-sheen-intrctve").prop("disabled",!1).text("Verify")}),d.val("").focus()))})):(badger.show("Incomplete form","error"),d.focus()),void a.preventDefault())}),$("#frm-login").on("submit",function(a){var c=$(this),d=$("#tbLoginId").val().trim(),e=$("#tbPwd").val().trim(),f=c.find(".pacer");return f.css({width:"0%"}),b=c.data("context"),c.data("no-click")?(c.data("no-click",""),void a.preventDefault()):(""===d||""===e?(badger.show("Incomplete form","error"),$("#tbLoginId").focus()):(f.show().animate({width:"50%"}),$("#btLogin").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Logging in..."),$.post(("review"===b?"../":"")+"login",{loginID:d,password:e},function(a){f.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btLogin").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Login")}),200===a.status?"banner"===b||"review"===b?(badger.show("Login successful. Please wait..",{persist:!0}),window.location.reload()):window.location.replace("institute/portfolio"):1001===a.status?window.location.href="custommsg?code=MSG06&loginId="+d:1002===a.status&&badger.show("Invalid credentials","error")})),void a.preventDefault())}),$("#frm-forgot-pwd").on("submit",function(a){var b=$("#tbLoginId").val().trim(),c=$(this).find(".pacer");if(c.css({width:"0%"}),""===b)badger.show("Incomplete form","error"),$("#tbLoginId").focus();else{c.show().animate({width:"50%"}),$("#btResetPwd").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Submitting...");var d={loginID:b};$.post("user/forgotPassword",JSON.stringify(d)).done(function(a){c.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide()}),$("#btResetPwd").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Submit"),200===a.status?window.location.href="custommsg?code=MSG03&resendTo="+a.data.email:1004===a.status&&badger.show("We do not recognize any account associated with this login ID","error",{stayTime:4})})}a.preventDefault()}),$("#frm-supp").on("submit",function(a){var b=$("#tbName").val().trim(),c=$("#tbEmail").val().trim(),d=$("#slSuppType option:selected").text(),e=$("#tbSuppText").val().trim(),f={},g=$(this),h=$(this).find(".pacer");h.css({width:"0%"}),""===b||""===c||""===e?(badger.show("Incomplete form","error"),$("#tbName").focus()):Pluto.Validator.Email.isValid(c)?(h.show().animate({width:"50%"}),$("#btSuppSend").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Submitting..."),f.name=b,f.email=c,f.suppType=d,f.suppTxt=e,f.addedOn=Date.now(),f.prevUrl=getParameterByName("prevUrl"),$.post("support",JSON.stringify(f)).done(function(a){h.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btSuppSend").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Submit")}),g.find("input, textarea").val(""),badger.show("merainstitute.com support contacted successfully",{persist:!0})}).fail(function(a){console.error("Error occurred:",a)})):(badger.show("Please provide a valid email address","warn"),$("#tbEmail").focus()),a.preventDefault()}),$("#frm-advertise").on("submit",function(a){var b=$("#tbName").val().trim(),c=$("#tbEmail").val().trim(),d=$("#tbContactNo").val().trim(),e=$("#tbQuery").val().trim(),f={},g=$(this),h=$(this).find(".pacer");h.css({width:"0%"}),""===b||""===c||""===d||""===e?(badger.show("Incomplete form","error"),$("#tbName").focus()):Pluto.Validator.Email.isValid(c)?Pluto.Validator.PhoneNumber.isValid(d)?(h.show().animate({width:"50%"}),$("#btAdvReq").removeClass("btn-sheen-intrctve").prop("disabled",!0).text("Submitting..."),f.name=b,f.email=c,f.contactNum=d,f.query=e,$.post("advertise",JSON.stringify(f)).done(function(a){h.animate({width:"100%"},function(){$(this).css({width:"0%"}).hide(),$("#btAdvReq").addClass("btn-sheen-intrctve").prop("disabled",!1).text("Submit")}),200===a.status?(g.find("input, textarea").val(""),badger.show("Request submitted successfully",{persist:!0})):badger.show("Couldn't submit request, please try again","warn")}).fail(function(a){console.error("Error occurred:",a)})):(badger.show("Please provide a valid contact number","warn"),$("#tbContactNo").focus()):(badger.show("Please provide a valid email address","warn"),$("#tbEmail").focus()),a.preventDefault()}),$(".js-rating-slidr").on("change",function(){$(this).prev("label").find(".usr-rating").text($(this).val())}),$("#frm-review-submit").on("submit",function(a){var c=$(this),d=$("#tbReviewContent").val().trim(),e=parseInt($("#rgRatingInfra").val()),f=parseInt($("#rgRatingFaculty").val()),g=parseInt($("#rgRatingMaterial").val()),h=$("#slCenters option:selected").val(),i="-1"===h?"":$("#slCenters option:selected").text(),j=c.data("user-id"),k=c.data("inst-id");if(b=c.data("context"),c.data("no-click"))return c.data("no-click",""),void a.preventDefault();if(!j||!k)return badger.show("Review can't be submitted right now","error"),void a.preventDefault();if(!(d||e||f||g))return badger.show("Please write a review or rate before submiting","error"),void a.preventDefault();var l={userId:j,instId:k,reviewedOn:Date.now(),review:d,center:i,centerId:h,rating:{infra:e,faculty:f,material:g}};$.post(("review"===b?"../":"")+"institute/reviewAndRating",JSON.stringify(l)).done(function(a){200===a.status&&(badger.show("Review submitted for verification",{stayTime:5}),$("#reviewId").val(a.data._id&&a.data._id.$oid))}).fail(function(a){console.log("Failed:",a)}),c.closest(".modal").fadeOut(),a.preventDefault()}),$("#btDelReview").on("click",function(){var a=$(this),c=$("#reviewId").val().trim();if(b=a.data("context"),!c)return void badger.show("You need to add a review before deleting it","error");var d={_id:c,isDeleted:!0};$.post(("review"===b?"../":"")+"institute/reviewAndRating",JSON.stringify(d)).done(function(a){200===a.status&&(badger.show("Review deleted successfully"),$("#reviewId").val(""))}).fail(function(a){console.log("Failed:",a)}),a.closest(".modal").fadeOut(),$("#tbReviewContent").val(""),$("#slCenters").val("-1"),$(".js-rating-slidr").val(0).change(),$("#reviewId").val("")}),window.googleInitComplete=function(){$("#btLoginGoogle").prop("disabled",!1).find(".social-txt").text("Connect with Google")},window.fbInitComplete=function(){$("#btLoginFacebook").prop("disabled",!1).find(".social-txt").text("Connect with Facebook")},$("#btLoginFacebook").on("click",function(){var a=$("#facebookPacer");b=$(this).data("context"),a.css({width:"0%"}).show().animate({width:"25%"}).prev("button").prop("disabled",!0).find(".social-txt").text("Connecting with Facebook..."),FB.login(function(b){b.authResponse?(a.show().animate({width:"50%"}),FB.api("/me?fields=id,name,email,gender,age_range,birthday",function(b){a.show().animate({width:"75%"}),c(b)})):a.animate({width:"0%"}).hide().prev("button").prop("disabled",!1).find(".social-txt").text("Connect with Facebook")},{scope:"public_profile,email",auth_type:"rerequest"})});var c=function(a){var b=$("#facebookPacer");a.email?FB.api("/me/picture",{redirect:!1,type:"large"},function(c){b.show().animate({width:"90%"}),e(a.email,a.name,c.data.url,a.gender,a.birthday,a.age_range,a.id,"facebook")}):b.animate({width:"0%"}).hide().prev("button").prop("disabled",!1).find(".social-txt").text("Connect with Facebook")};$("#btLoginGoogle").on("click",function(){b=$(this).data("context"),gapi.auth.signIn({clientid:"408132528531-f5o8j8fnff057qca7fjn9qc5ga9h7i1g.apps.googleusercontent.com",cookiepolicy:"single_host_origin",callback:d,scope:"https://www.googleapis.com/auth/plus.profile.emails.read https://www.googleapis.com/auth/plus.login"})});var d=function(a){var b=$("#googlePacer");if("immediate_failed"===a.error);else if(b.css({width:"0%"}).show().animate({width:"25%"}).prev("button").prop("disabled",!0).find(".social-txt").text("Connecting with Google..."),a.status.signed_in){if("PROMPT"===a.status.method){var c=gapi.client.plus.people.get({userId:"me",fields:"id,displayName,image,gender,birthday,ageRange,emails"});b.show().animate({width:"65%"}),c.execute(function(a){b.show().animate({width:"80%"});for(var c="",d=0,f=a.emails||[],g=f.length;g>d;d++)"account"===a.emails[d].type&&(c=a.emails[d].value);var h=a.id,i=a.displayName,j=a.gender,k=a.image.url,l=a.ageRange,m=a.birthday;b.show().animate({width:"90%"}),e(c,i,k,j,m,l,h,"googlePlus")})}}else"access_denied"===a.error&&b.animate({width:"0%"}).hide().prev("button").prop("disabled",!1).find(".social-txt").text("Connect with Google")},e=function(a,c,d,e,f,g,h,i){var j={loginId:a,name:c,profileImg:d,gender:e,birthday:f,ageRange:g,socialId:h,socialType:i};$.post(("review"===b?"../":"")+"user/regin",JSON.stringify(j),function(a){200===a.status?"student"===a.data.role||"STUDENT"===a.data.role?"banner"===b||"review"===b?window.location.reload():window.location.href=".":window.location.href="institute/portfolio":console.log("Error in register. Status:",a.status,"; Desc:",a.statusDesc)})}});